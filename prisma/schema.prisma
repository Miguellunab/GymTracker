generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}


model WeightLog {
  id        String   @id @default(cuid())
  weight    Float
  date      DateTime @default(now())
  createdAt DateTime @default(now())
}


model Routine {
  id          String   @id @default(cuid())
  name        String   // "Push Day", "Pull Day"
  daysOfWeek  String[] // ["Monday", "Thursday"]
  exercises   RoutineExercise[]
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Exercise {
  id           String   @id @default(cuid())
  name         String   @unique
  muscleGroup  String   // "Chest", "Back", "Legs"
  notes        String?
  routines     RoutineExercise[]
  workoutSets  WorkoutSet[]
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model RoutineExercise {
  id          String   @id @default(cuid())
  routineId   String
  exerciseId  String
  order       Int      @default(0) // Control display order
  
  routine     Routine  @relation(fields: [routineId], references: [id], onDelete: Cascade)
  exercise    Exercise @relation(fields: [exerciseId], references: [id])

  @@index([routineId])
  @@index([exerciseId])
}

model WorkoutSession {
  id              String   @id @default(cuid())
  date            DateTime @default(now())
  routineName     String?  // "Pecho / Espalda", "Pierna", etc. or "Rest"
  durationSeconds Int?     // Total time in seconds
  totalCalories   Float?   // Calculated
  
  didCardio       Boolean  @default(false)
  cardioMinutes   Int?
  cardioIntensity String?  // "Low", "Medium", "High"
  
  notes           String?
  
  sets            WorkoutSet[]
  
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model WorkoutSet {
  id                String   @id @default(cuid())
  workoutSessionId  String
  exerciseId        String
  
  weight            Float
  reps              Int
  isWarmup          Boolean  @default(false)
  rpe               Int?     // 1-10
  restTimeUsed      Int?     // seconds from timer

  // Supersets support (Biseries)
  weight2           Float?
  reps2             Int?
  
  session   WorkoutSession @relation(fields: [workoutSessionId], references: [id], onDelete: Cascade)
  exercise  Exercise       @relation(fields: [exerciseId], references: [id])

  @@index([workoutSessionId])
  @@index([exerciseId])
}
